<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>@ozgurvurgun | Guard</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Guard Nedir? Neden Var? Şöyle düşün:
Bir apartman giriş kapısı var ama herkese açık değil. Kapıda bir güvenlik görevlisi var ve sana sorular soruyor:
Kimsin? Giriş iznin var mı? Bu kata çıkabilir misin? Bu daireye özel yetkin var mı? İşte bu Angular Gaurd tam olarak bu işi yapar. Uygulamanın rotaları arasında geçiş yapılırken kim geçebilir, kim geçemez sorularına cevap verir.
Guard Ne İş Yapar? Angular&rsquo;daki Router sistemi sayesinde sayfalar arasında geziniriz (/login, /dashboard, /admin vs)."><meta property="og:image" content><meta property="og:title" content="Guard"><meta property="og:description" content="Guard Nedir? Neden Var? Şöyle düşün:
Bir apartman giriş kapısı var ama herkese açık değil. Kapıda bir güvenlik görevlisi var ve sana sorular soruyor:
Kimsin? Giriş iznin var mı? Bu kata çıkabilir misin? Bu daireye özel yetkin var mı? İşte bu Angular Gaurd tam olarak bu işi yapar. Uygulamanın rotaları arasında geçiş yapılırken kim geçebilir, kim geçemez sorularına cevap verir.
Guard Ne İş Yapar? Angular&rsquo;daki Router sistemi sayesinde sayfalar arasında geziniriz (/login, /dashboard, /admin vs)."><meta property="og:type" content="article"><meta property="og:url" content="https://ozgurvurgun.github.io/angular/7-guard/"><meta property="article:section" content="angular"><meta property="article:published_time" content="2025-07-23T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-23T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Guard"><meta name=twitter:description content="Guard Nedir? Neden Var? Şöyle düşün:
Bir apartman giriş kapısı var ama herkese açık değil. Kapıda bir güvenlik görevlisi var ve sana sorular soruyor:
Kimsin? Giriş iznin var mı? Bu kata çıkabilir misin? Bu daireye özel yetkin var mı? İşte bu Angular Gaurd tam olarak bu işi yapar. Uygulamanın rotaları arasında geçiş yapılırken kim geçebilir, kim geçemez sorularına cevap verir.
Guard Ne İş Yapar? Angular&rsquo;daki Router sistemi sayesinde sayfalar arasında geziniriz (/login, /dashboard, /admin vs)."><script src=https://ozgurvurgun.github.io/js/feather.min.js></script>
<link href=https://ozgurvurgun.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://ozgurvurgun.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://ozgurvurgun.github.io/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css media="(prefers-color-scheme: dark)"><style>input[type=text],input[type=password]{font-size:16px!important;touch-action:manipulation}</style></head><body><div class=content><header><div class=main><a href=https://ozgurvurgun.github.io/>@ozgurvurgun</a></div><nav><a href=/>main</a>
<a href=/shorts>shorts</a>
<a href=/projects>projects</a>
<a href=/angular>angular</a>
<a href=/nestjs>nestJS</a>
<a href=/links>links</a>
<a href=/about>me</a></nav></header><main><article><div class=post-container><div class=post-content><div class=title><h1 class=title>Guard</h1><div class=meta>Posted on Jul 23, 2025</div></div><section class=body><h2 id=guard-nedir-neden-var>Guard Nedir? Neden Var?</h2><p>Şöyle düşün:</p><p>Bir apartman giriş kapısı var ama herkese açık değil. Kapıda bir güvenlik görevlisi var ve sana sorular soruyor:</p><ul><li>Kimsin?</li><li>Giriş iznin var mı?</li><li>Bu kata çıkabilir misin?</li><li>Bu daireye özel yetkin var mı?</li></ul><p>İşte bu <strong>Angular Gaurd</strong> tam olarak bu işi yapar. Uygulamanın rotaları arasında geçiş yapılırken kim geçebilir, kim geçemez sorularına cevap verir.</p><h2 id=guard-ne-iş-yapar>Guard Ne İş Yapar?</h2><p>Angular&rsquo;daki Router sistemi sayesinde sayfalar arasında geziniriz (<code>/login</code>, <code>/dashboard</code>, <code>/admin</code> vs). Ama bazı sayfalar:</p><ul><li>Giriş yapmış kullanıcıya özel olabilir</li><li>Yalnızca admin&rsquo;lere açık olabilir</li><li>Form doldurmadan geçiş yapılmayabilir</li><li>Dışarıdan çıkarken “kaydetmediğin değişiklikler var” diye
uyarı verebilir</li></ul><p>İşte bu geçişlere engel olmak ya da izin vermek için <strong>guard</strong> yazılır.</p><h2 id=angularda-5-tür-guard-vardır>Angular’da 5 Tür Guard Vardır</h2><table><thead><tr><th>Guard Türü</th><th>Ne zaman devreye girer?</th></tr></thead><tbody><tr><td><code>CanActivate</code></td><td>Route&rsquo;a gitmeden önce <strong>erişim izni</strong> kontrolü</td></tr><tr><td><code>CanActivateChild</code></td><td>Child route’lara geçmeden önce</td></tr><tr><td><code>CanDeactivate</code></td><td>Route’tan çıkmadan önce, <strong>çıkış izni</strong></td></tr><tr><td><code>CanLoad</code></td><td>Lazy-loaded modül yüklenmeden önce</td></tr><tr><td><code>Resolve</code></td><td>Route açılmadan önce veri hazırla (guard değil ama aynı yapıda)</td></tr></tbody></table><h2 id=ilk-guardımızı-yazalım-canactivate>İlk Guard&rsquo;ımızı Yazalım: <code>CanActivate</code></h2><p>Guard Oluştur</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ng g guard auth
</span></span></code></pre></div><p>Bu komut sana şu dosyayı oluşturur:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AuthGuard</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanActivate</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>canActivate</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Kullanım (Route&rsquo;a uygula)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dashboard&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>DashboardComponent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>canActivate</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>AuthGuard</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>];
</span></span></code></pre></div><blockquote><p><code>canActivate</code> Bu route’a girilmeden önce çalışır.</p></blockquote><h2 id=örnek-giriş-yapmamışsa-reddet>Örnek: Giriş Yapmamışsa Reddet</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AuthGuard</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanActivate</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>authService</span>: <span style=color:#66d9ef>AuthService</span>, <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>router</span>: <span style=color:#66d9ef>Router</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>canActivate</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>authService</span>.<span style=color:#a6e22e>isLoggedIn</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>navigate</span>([<span style=color:#e6db74>&#39;/login&#39;</span>]);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=diğer-guard-türleri>Diğer Guard Türleri</h2><p>CanActivateChild</p><blockquote><p>Bir parent route&rsquo;un altında alt sayfalar varsa, sadece child&rsquo;a geçişi kontrol eder.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;admin&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AdminComponent</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>canActivateChild</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>AdminGuard</span>],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;users&#39;</span>, <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>UserListComponent</span> },
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;logs&#39;</span>, <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>LogComponent</span> }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>CanDeactivate</p><blockquote><p>Kullanıcı sayfadan çıkarken seni uyarabilir.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>canDeactivate</span>(<span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>FormComponent</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>dirty</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#34;Değişiklikler kaydedilmedi. Yine de çıkmak istiyor musun?&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>CanLoad</p><blockquote><p>Lazy-load edilen modüllerin, daha yüklenmeden önce engellenmesini sağlar.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;admin&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loadChildren</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;./admin/admin.module&#39;</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>m</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>AdminModule</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>canLoad</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>AdminGuard</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>Not: <code>CanActivate</code> çalışır ama modül olarak çoktan yüklenmiş olabilir. <code>CanLod</code> daha erkenden devreye girer.</p></blockquote><p>Resolve
Bu teknik olarak guard değil ama aynı konsepttedir:</p><blockquote><p>Sayfa açılmadan önce gerekli veriyi hazırla.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;profile/:id&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>ProfileComponent</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolve</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>user</span>: <span style=color:#66d9ef>UserResolver</span> }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Component içinde:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>data</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>user</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>user</span>;
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=guard-dönüş-tipleri>Guard Dönüş Tipleri</h2><p>Guard&rsquo;lar şunları dönebilir:</p><ul><li><code>true</code> geçişe izin ver</li><li><code>false</code> geçişi engelle</li><li><code>UrlTree</code> yönlendir</li><li><code>Observable&lt;boolean | UrlTree></code> asenkron izin</li><li><code>Promise&lt;boolean | UrlTree></code></li></ul><h2 id=performans-ve-best-practices>Performans ve Best Practices</h2><ul><li>Auth işlemleri her yerde değil, merkezi Guard içinde tut.</li><li>CanLoad, sadece lazy-loaded modüllerde işe yarar.</li><li>CanDeactivate ile formları koru, kullanıcıyı uyarmayı unutma.</li><li>Her Guard&rsquo;ı tek sorumluluk ilkesiyle yaz (SRP).</li></ul><h2 id=gerçek-güvenlik-nerede-başlar>Gerçek Güvenlik Nerede Başlar?</h2><p>Guard kullanarak bir kullancıyı <code>/admin</code> sayfasına girmekten alıkoyabilirsin. Ama unutmaman gereken çok kritik bir gerçek var:</p><blockquote><p>Frontend, her zaman manipüle edilebilir.</p></blockquote><p>Kullanıcı:</p><ul><li>Chrome DevTools ile localStorage’daki token’ı değiştirebilir.</li><li>Network isteğini taklit edebilir.</li><li>Route&rsquo;a elle erişmeye çalışabilir.</li><li>Guard kodunu içeren JS bundle&rsquo;ı analiz edebilir.</li></ul><p>Guard, sadece şunu sağlar:</p><ul><li>“Normal kullanıcı” senaryosunda istenmeyen erişimi önler.</li><li>Uygulama içinde &ldquo;mantıklı bir akış&rdquo; sağlar.</li></ul><h2 id=nihai-güvenlik-backenddedir>Nihai Güvenlik Backend’dedir</h2><p>Gerçek güvenlik önlemleri her zaman sunucu tarafında (backend) alınmalıdır:</p><ul><li>Bir kullanıcı <code>/admin</code> sayfasına gitse bile, örneğin API <code>/admin/data</code> isteğine cevap vermemeli.</li><li>Backend, token&rsquo;ı doğrulamalı, yetkiyi kontrol etmeli.</li><li>Hangi kullanıcının hangi role sahip olduğu orada karar verilmelidir.</li><li>Sunucu, frontend&rsquo;den gelen her veriyi şüpheli kabul etmeli.</li></ul><h2 id=özet>Özet</h2><ul><li>Guard, bir rotaya erişim izni veya çıkış kontrolü yapar.</li><li>5 tür guard var: CanActivate, CanActivateChild, CanDeactivate, CanLoad, Resolve</li><li>Kullanıcı girişi, yetki, form koruma gibi durumlarda devreye girer.</li><li>Doğru yerde doğru guard kullanımı güvenli, kontrollü, kullanıcı dostu app demektir.</li></ul></section><div class=post-tags></div></div></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/ozgurvurgun rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://linkedin.com/in/ozgurvurgun1 rel=me title=Linkedin><i data-feather=linkedin></i></a>
<a class=border></a><a class=soc href=http://emre.xyz/me.vcf rel=me title=VCF><i data-feather=phone></i></a>
<a class=border></a><a class=soc href=http://emre.xyz/resume.pdf rel=me title=Resume><i data-feather=file-text></i></a>
<a class=border></a></div><div class=footer-info>2025 ozgurvurgun</div></footer><script>feather.replace()</script><script src=https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js></script>
<script>const keyInput=document.getElementById("key"),contentEl=document.getElementById("content"),encryptedText=contentEl.textContent.trim();keyInput.addEventListener("input",()=>{const e=keyInput.value.trim();if(!e){contentEl.textContent=encryptedText;return}try{const n=CryptoJS.AES.decrypt(encryptedText,e),t=n.toString(CryptoJS.enc.Utf8);if(!t)throw new Error("Çözülemedi");contentEl.textContent=t}catch{contentEl.textContent=encryptedText}})</script></div></body></html>